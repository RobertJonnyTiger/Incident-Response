rule LockyRansomware {
meta:
	description = "rule to detect malware of ransomware type called Locky"
	hash_md5 = "b06d9dd17c69ed2ae75d9e40b2631b42"
	hash_sha1 = "b606aaa402bfe4a15ef80165e964d384f25564e4"
	hash_sha256 = "bc98c8b22461a2c2631b2feec399208fdc4ecd1cd2229066c2f385caa958daa3"
	imphash = "0FCEA3AF550AD0A893E93808DCCF17F4"
	sector_text_hash = "D10A376572A1B107FA4157009223EDB1"
	sector_rdata_hash = "F093C3F1C3A979DC5E0E622C993043A9"
	sector_data_hash = "B765887F1CCA7B8EB7FC07FA8EB982B8"
	sector_rsrc_hash = "422ED60A1303FF02CDD0E1E518D33F01"
	date = "2005-06-25"

strings:
	$mz = {4D 5A}
	$u0 = "FileSee.com" ascii
	$u1 = "0.37.213.27"
	$u2 = "2013" ascii
	$u4 = "Lipreading Fenced" ascii
	$ux5 = "uA2c861" wide
	$ux6 = "&c5l6t5 JyTm73u7 kL6sBT j85Z074" wide
	$ux7 = "&ht49y39 wJt5zXU" wide
	$ux8 = "&Z3ZW3 K6P638e yv5PTs" wide
	$ux9 = "&kA88 f006q9" wide
	$ux10 = "&K706S" wide
	$uni_string11 = "&GHS" wide
	$uni_string12 = "&CmQQK jF71w0m4 XD7" wide
	$uni_string13 = "&Ujc5" wide
	$uni_string14 = "&YU4 L2q1505 " wide
	$uni_string15 = "32880x K0QB169" wide
	$uni_string16 = "&Dgc VJ592op2" wide
	$uni_string17 = "&v9SVCzg AHdhC1E" wide
	$uni_string18 = "&o221 VR69953 McpL5U0E OREu22J" wide
	$uni_string19 = "&Y9le1 d78Q4mcR fqX62" wide
	$uni_string20 = "&e87h Y5MN0 B6801N C5B3K" wide
	$uni_string21 = "d1Ypn3" wide
	$uni_string22 = "wM124m F8Q uo4D1" wide
	$uni_string23 = " Microsoft Sans Serif" wide
	$uni_string24 = "HvEEL8a V782Jcv" wide
	$uni_string25 = "XA045y1" wide
	$uni_string26 = "NKw R872Q297" wide
	$uni_string27 = "h0Wv" wide
	$uni_string28 = "CJW9580z s2J0X" wide
	$uni_string30 = "yEUK2 DMUK gY47IG x5Ewn03" wide
	$uni_string31 = "xNTT p2B5V" wide
	$uni_string32 = "zq7y25 QVE24 WSfm w8MF6" wide
	$uni_string33 = "ZQS01n" wide
	$uni_string34 = "L6TDY2A4X" wide
	$uni_string35 = "Hkh Xi8T5" wide
	$uni_string36 = "Candara" wide
	$uni_string37 = "ty3834 lew0 REY9j S7AKWo4" wide
	$uni_string38 = "kR3113hA r16VKeI" wide
	$uni_string39 = "Yf5j0 FA2BQXE6 T6P733Z YL48" wide
	$uni_string40 = "qW2aZj0 RT1 Vi05" wide
	$uni_string41 = "z2ad300" wide
	$uni_string42 = "j3qBP9" wide
	$uni_string43 = "g3S0 N3zZZR9" wide
	$uni_string44 = "8A2!" wide
	$uni_string45 = "vcPEc hQ3P g28Km9 E5g70P" wide
	$uni_string46 = "wE621247" wide
	$uni_string47 = "HCentury" wide
	$uni_string48 = "B0VZf" wide
	$uni_string49 = "B8640 t3it ziS492" wide
	$uni_string50 = "v71w8557L" wide
	$uni_string51 = "JuXz3P08 Fkz727 fh4b5E7 k4X0" wide
	$uni_string52 = "Cambria" wide
	$uni_string53 = "h13J67 T7z Lh2242bW" wide
	$uni_string54 = "hLbPhA Dpm3f12Z" wide
	$uni_string55 = "Nls82 F31 bTs02P" wide
	$uni_string56 = "rWR Fd12I QT9w66Y" wide
	$uni_string57 = "u0g10aY" wide
	$uni_string58 = "Constantia" wide
	$uni_string59 = "eS01jFt50" wide
	$uni_string60 = "faUm" wide
	$uni_string61 = "0Calibri" wide
	$uni_string62 = "tB70F15 j24 D8H J09" wide
	$uni_string63 = "E56467wJ f14247Q9" wide
	$uni_string64 = "lkO2 G8x2VbTL" wide
	$uni_string65 = "L44U4uu5 k8X3" wide
	$uni_string66 = "eo4sT09782" wide
	$uni_string67 = "N9366ig PAn4jJ2 va6653" wide
	$import0 = "GetGUIThreadInfo"
	$import1 = "GetCapture" ascii
	$import2 = "GetSecurityDescriptorDacl" ascii
	$import3 = "GetSidSubAuthorityCount" ascii
	$import4 = "GetKernelObjectSecurity" ascii
	$import5 = "GetSidSubAuthority" ascii
	$import6 = "LookupPrivilegeValueA" ascii
	$import7 = "GetSidIdentifierAuthority" ascii
	$import8 = "OpenThreadToken" ascii
	$import9 = "LsaQueryInformationPolicy" ascii
	$import10 = "MakeAbsoluteSD" ascii
	$import11 = "AddAce" ascii
	$import12 = "SetNamedSecurityInfoW" ascii
	$import13 = "SetSecurityDescriptorSacl" ascii
	$import14 = "MakeSelfRelativeSD" ascii
	$import15 = "SetEntriesInAclA" ascii
	$import16 = "GetSidLengthRequired" ascii
	$import17 = "SetEntriesInAclW" ascii
	$import18 = "GetAclInformation" ascii
	$import19 = "RegSetValueExA" ascii
	$import20 = "RegDeleteKeyA" ascii
	$import21 = "RegLoadKeyA" ascii
	$import22 = "RegConnectRegistryA" ascii
	$import23 = "RegSetValueW" ascii
	$import24 = "RegFlushKey" ascii
	$import25 = "RegSetValueA" ascii
	$import26 = "mouse_event" ascii
	$import27 = "NotifyWinEvent" ascii
	$import28 = "CreateProcessAsUserA" ascii
	$import29 = "PostThreadMessageW" ascii
	$import30 = "GetWindowModuleFileNameA" ascii
	$import31 = "GetWindowThreadProcessId" ascii
	$import32 = "RegisterEventSourceA" ascii
	$import33 = "OpenEventLogW" ascii
	$import34 = "CreateDesktopW" ascii
	$import35 = "GetProcessWindowStation" ascii
	$import36 = "ChangeDisplaySettingsW" ascii
	$import37 = "GetCursorPos" ascii
	$import38 = "OpenClipboard" ascii
	$import39 = "SetClipboardData" ascii
	$import40 = "CloseClipboard" ascii
	$import41 = "DdeDisconnect" ascii
	$import42 = "GetClipboardFormatNameW" ascii
	$import43 = "EncryptFileW" ascii
	$import44 = "InitiateSystemShutdownA" ascii
	$a1 = "HydrantsLakeside" ascii
	$a2 = "GrimeOcean" ascii
	$a3 = "LightensLynx" ascii
	$a4 = "LuckyMulticultural" ascii
	$a5 = "LysineGenetic" ascii
	$a6 = "OverlandFounts" ascii
	$a7 = "MacroscopicMagnetisation" ascii
	$a8 = "MotorsNeonate" ascii
	$a9 = "FoundationsMountains" ascii
	$a10 = "HandmaidenFillip" ascii
	$a11 = "KindleLathe" ascii
	$a12 = "InstitutedHeighten" ascii
	$a13 = "HolidaysMultiprocessors" ascii
	$a14 = "LocativeInterlocks" ascii
	$a15 = "InnermostMicrophones" ascii
	$a16 = "OffsetJacket" ascii
	
condition:
	($mz at 0)
	20 of $uni_string1
	$u0 and $u1 and $u3 and $u4
	2 of ($a*) or 4 of ($ux*)
	5 of ($import*)
	any of them
}
